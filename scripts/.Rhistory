scale_fill_manual(values = c("white", "white")) +  # Keeping base color white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic() +
theme(legend.title = element_text(size = 12), legend.text = element_text(size = 10))
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup), pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
alpha = 0.6,
pattern_density = 0.4,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup), pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
alpha = 0.6,
pattern_density = 0.8,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup), pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
alpha = 0.6,
pattern_density = 0.2,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup), pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms)) +
geom_density_pattern(
aes(pattern = factor(AgeGroup),
pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
fill = "white",   # set a constant fill
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"   # update the legend title to come from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup),
pattern_angle = ifelse(factor(AgeGroup) == "Group1", 45, -45)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms)) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white")) +  # Base colors white to highlight the pattern
labs(
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density(alpha = 0.6) +
scale_fill_manual(values = colorBlindBlack8[c(2, 4)]) +
labs(
#title = "Density of base forms per book by age group",
x = "Number of base forms",
y = "Density",
fill = "Age group"
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
scale_pattern_manual(values = c("1" = "stripe", "2" = "circle")) +   # manually set patterns
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms)) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
fill = "white",          # set fill as a constant
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black",
key_glyph = "density_pattern"  # force legend key to use the density pattern glyph
) +
scale_pattern_manual(values = c("1" = "stripe", "2" = "circle")) +
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"
) +
guides(
pattern = guide_legend(
override.aes = list(
fill = "white",
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
)
)
) +
theme_classic()
library(grid)
draw_key_custom_density <- function(data, params, size) {
# This is a simple fallback that draws a rectangle.
# You might need to enhance it to replicate your pattern details.
grid::rectGrob(width = 0.8, height = 0.8,
gp = grid::gpar(col = data$colour,
fill = data$fill,
lwd = data$size * .pt))
}
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
fill = "white",
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black",
key_glyph = draw_key_custom_density  # use your custom key glyph
)
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggplot(per_book_counts, aes(x = UniqueBaseForms, fill = factor(AgeGroup))) +
geom_density_pattern(
aes(pattern = factor(AgeGroup)),
alpha = 0.6,
pattern_density = 0.3,
pattern_fill = "black",
pattern_colour = "black"
) +
scale_fill_manual(values = c("white", "white"), guide = "none") +  # disable fill legend
labs(
x = "Number of base forms",
y = "Density",
pattern = "Age group"    # legend now comes from pattern
) +
theme_classic()
ggsave(plot = last_plot(), filename = paste0(plots, "baseForms_ageGroup_density_bw.pdf"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "baseForms_ageGroup_density_bw.jpg"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "baseForms_ageGroup_density_bw.tif"),
width = 6, height = 4, compression = "lzw", dpi = 600)
ggplot(ideophones_per_book, aes(x = factor(AgeGroup), y = IdeophonesPerPage, fill = factor(AgeGroup))) +
geom_violin(alpha = 0.6, trim = FALSE) +
geom_boxplot(width = 0.1, outlier.shape = NA, notch = TRUE) +
scale_fill_manual(values = colorBlindBlack8[c(2, 4)]) +
labs(
#title = "Ideophones per page by age group",
x = "Age group",
y = "Ideophones per page"
) +
theme_classic() +
ylim(c(0,4.5)) +
guides(fill = "none")
ideophones_per_book <- df %>%
group_by(BookTitle, AgeGroup, PageCount) %>%
reframe(
TotalIdeophones = n(),  # Total ideophones in the book
IdeophonesPerPage = TotalIdeophones / PageCount,  # Ideophones per page
.groups = "drop"
)
ideophones_per_book %>%
group_by(AgeGroup) %>%
reframe(
AvgIdeophonesPerPage = mean(IdeophonesPerPage, na.rm = TRUE),
MedianIdeophonesPerPage = median(IdeophonesPerPage, na.rm = TRUE),
SD_IdeophonesPerPage = sd(IdeophonesPerPage, na.rm = TRUE),
TotalBooks = n(),
.groups = "drop"
)
ggplot(ideophones_per_book, aes(x = factor(AgeGroup), y = IdeophonesPerPage, fill = factor(AgeGroup))) +
geom_violin(alpha = 0.6, trim = FALSE) +
geom_boxplot(width = 0.1, outlier.shape = NA, notch = TRUE) +
scale_fill_manual(values = colorBlindBlack8[c(2, 4)]) +
labs(
#title = "Ideophones per page by age group",
x = "Age group",
y = "Ideophones per page"
) +
theme_classic() +
ylim(c(0,4.5)) +
guides(fill = "none")
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage)) +
geom_point(alpha = 0.7, color = colorBlindBlack8[2]) +
geom_smooth(method = "lm", color = colorBlindBlack8[4], se = FALSE) +
labs(#title = "Correlation between number of pages and ideophones per page",
x = "Number of pages",
y = "Ideophones per page") +
theme_classic()
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, color = factor(AgeGroup))) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE) +
scale_color_manual(values = colorBlindBlack8[c(2, 4)]) +
labs(
#title = "Correlation between number of pages and ideophones per page",
x = "Number of pages",
y = "Ideophone-like words per page",
color = "Age group"
) +
theme_minimal()
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6, color = "black") +  # Outline for all points
geom_smooth(method = "lm", se = FALSE, color = "black") +  # Black regression lines
scale_shape_manual(values = c(21, 16)) +  # 21 = hollow circle, 16 = solid circle
scale_fill_manual(values = c("white", "grey60")) +  # Empty & grey filled dots
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group"
) +
theme_minimal()
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey60")) +  # White and grey fills
scale_color_manual(values = c("black", "grey60")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal()
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey50")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal()
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.pdf"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.jpg"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.tif"),
width = 6, height = 4, compression="lzw", dpi=600);
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey50")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", color = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey50")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", color = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey50")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.pdf"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.jpg"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.tif"),
width = 6, height = 4, compression="lzw", dpi=600);
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey90")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey80")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey70")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggplot(ideophones_per_book, aes(x = PageCount, y = IdeophonesPerPage, shape = factor(AgeGroup), fill = factor(AgeGroup), color = factor(AgeGroup))) +
geom_point(size = 3, alpha = 0.6) +  # Plot points with desired styling
geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(AgeGroup)), linewidth = 1) +  # Regression lines
scale_shape_manual(values = c(21, 21)) +  # Both groups use shape 21 (filled dots with outline)
scale_fill_manual(values = c("white", "grey80")) +  # White and grey fills
scale_color_manual(values = c("black", "grey50")) +  # Black and grey outlines
scale_linetype_manual(values = c("solid", "solid")) +  # Keep regression lines solid
labs(
x = "Number of pages",
y = "Ideophone-like words per page",
shape = "Age group",
fill = "Age group",
color = "Age group"
) +
theme_minimal() +
guides(shape = "none", fill = "none", linetype = "none")  # Remove all legends related to AgeGroup
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.pdf"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.jpg"),
width = 6, height = 4);
ggsave(plot = last_plot(), filename = paste0(plots, "cor_PageCount_IdeophonesPerPage_AgeGroup_bw.tif"),
width = 6, height = 4, compression="lzw", dpi=600);
